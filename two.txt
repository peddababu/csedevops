this is code changes from the svn repository